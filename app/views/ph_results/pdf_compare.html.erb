<html>
<head>
<style type="text/css">
    body {
        font-family: "Myriad Pro","Myriad Web", helvetica, sans-serif;
    }

    table {
        *border-collapse: collapse; /* IE7 and lower */
        border-spacing: 0;
    }
    th2:first-child {
        -moz-border-radius: 6px 0 0 0;
        -webkit-border-radius: 6px 0 0 0;
        border-radius: 6px 0 0 0;
    }

    th2:last-child {
        -moz-border-radius: 0 6px 0 0;
        -webkit-border-radius: 0 6px 0 0;
        border-radius: 0 6px 0 0;
    }


    .bordered {
        border-left: solid #2b4950 4px;
        border-right: solid #2b4950 4px;
        border-bottom: solid #2b4950 5px;
        -moz-border-radius: 6px;
        -webkit-border-radius: 6px;
        border-radius: 6px;
        -webkit-box-shadow: 0 1px 1px #ccc;
        -moz-box-shadow: 0 1px 1px #ccc;
        box-shadow: 0 1px 1px #ccc;
    }

    .bordered_white {
        width: 90px;
        background-color:#ffffff;
        border-left: solid #ffffff 4px;
        border-right: solid #ffffff 4px;
        border-bottom: solid #ffffff 3px;
        border-top: solid #ffffff 3px;
        -moz-border-radius: 6px;
        -webkit-border-radius: 6px;
        border-radius: 6px;
        -webkit-box-shadow: 0 1px 1px #ccc;
        -moz-box-shadow: 0 1px 1px #ccc;
        box-shadow: 0 1px 1px #ccc;
    }

    .bordered_gray {
        width: 90px;
        background-color:#71c5c8 !important;
        border-left: solid #71c5c8 4px !important;
        border-right: solid #71c5c8 4px !important;
        border-bottom: solid #71c5c8 5px !important;
        -moz-border-radius: 6px;
        -webkit-border-radius: 6px;
        border-radius: 6px;
    }


    .bordered tr {
        border: solid #ccc 3px;
    }

    .bordered_gray tr {
        border: solid #71c5c8 3px;
    }


    .bordered td, .bordered th {
        border-left: 1px solid #ccc;
        border-top: 1px solid #ccc;
        padding: 5px;
        text-align: left;
    }

    .bordered_white th {
        border-left: 1px solid #ccc;
        border-top: 1px solid #ccc;
        padding: 5px;
        text-align: left;
        background-color:#ffffff;
    }

    .bordered_gray th {
        padding: 5px;
        text-align: left;
        background-color:#71c5c8 !important;
    }


    .bordered th {
        background-color: #2b4950;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#2b4950), to(#2b4950));
        background-image: -webkit-linear-gradient(top, #2b4950, #2b4950);
        background-image:    -moz-linear-gradient(top, #2b4950, #2b4950);
        background-image:     -ms-linear-gradient(top, #2b4950, #2b4950);
        background-image:      -o-linear-gradient(top, #2b4950, #2b4950);
        background-image:         linear-gradient(top, #2b4950, #2b4950);
        border-top: none;
    // text-shadow: 0 1px 0 rgba(255,255,255,.5);
        font-weight: normal;
    }

    .bordered_white th {
        background-color: #ffffff;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#ffffff), to(#ffffff)) !important;
        background-image: -webkit-linear-gradient(top, #ffffff, #ffffff) !important;
        background-image:    -moz-linear-gradient(top, #ffffff, #ffffff) !important;
        background-image:     -ms-linear-gradient(top, #ffffff, #ffffff) !important;
        background-image:      -o-linear-gradient(top, #ffffff, #ffffff) !important;
        background-image:         linear-gradient(top, #ffffff, #ffffff) !important;
        -webkit-box-shadow: 0 1px 0 rgba(255,255,255,.8) inset;
        -moz-box-shadow:0 1px 0 rgba(255,255,255,.8) inset;
        box-shadow: 0 1px 0 rgba(255,255,255,.8) inset;
        border-top: none;
        text-shadow: 0 1px 0 rgba(255,255,255,.5);
        font-weight: normal;
        font-size:13px;
        padding: 5px !important;
    }


    .bordered_gray th {
        padding-top: 4px !important;
        padding-bottom: 4px !important;
        background-color: #71c5c8;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#71c5c8), to(#71c5c8)) !important;
        background-image: -webkit-linear-gradient(top, #71c5c8, #71c5c8) !important;
        background-image:    -moz-linear-gradient(top, #71c5c8, #71c5c8) !important;
        background-image:     -ms-linear-gradient(top, #71c5c8, #71c5c8) !important;
        background-image:      -o-linear-gradient(top, #71c5c8, #71c5c8) !important;
        background-image:         linear-gradient(top, #71c5c8, #71c5c8) !important;
        border-top: none;
        text-shadow: 0 1px 0 rgba(255,255,255,.5);
        font-weight: bold;
        font-size:15px;
        border:0px;
        padding: 5px !important;
    }


    .bordered td:first-child, .bordered th:first-child {
        border-left: none;
    }

    .bordered_white td:first-child, .bordered_white th:first-child {
        border-left: none;
    }

    .bordered_gray td:first-child, .bordered_gray th:first-child {
        border-left: none;
    }

    .bordered_dark {

        -moz-border-radius: 6px;
        -webkit-border-radius: 6px;
        border-radius: 6px;
        -webkit-box-shadow: 0 1px 1px #009da5;
        -moz-box-shadow: 0 1px 1px #009da5;
        box-shadow: 0 1px 1px #009da5;
    }

    .bordered_dark tr {
        border: solid #ccc 3px;
    }

    .bordered_dark td {
        background-color: #009da5;
        padding-right: 10px;
        padding-left: 10px;
        padding-bottom: 5px;
        padding-top: 5px;
        text-align: left;
    }

    .bordered_dark th {
        padding-right: 10px;
        padding-left: 10px;
        padding-bottom: 5px;
        padding-top: 5px;
        text-align: left;
    }

    .bordered_dark th {
        border-top: none;
        font-weight: normal;
    }

    .bordered_dark td:first-child, .bordered_dark th:first-child {
        border-left: none;
    }

    .bordered_dark th:first-child {
        -moz-border-radius: 6px 0 0 0;
        -webkit-border-radius: 6px 0 0 0;
        border-radius: 6px 0 0 0;
    }

    .bordered_dark th:last-child {
        -moz-border-radius: 0 6px 0 0;
        -webkit-border-radius: 0 6px 0 0;
        border-radius: 0 6px 0 0;
    }

    .bordered_dark th:only-child{
        -moz-border-radius: 6px 6px 0 0;
        -webkit-border-radius: 6px 6px 0 0;
        border-radius: 6px 6px 0 0;
    }

    .bordered_dark tr:last-child td:first-child {
        -moz-border-radius: 0 0 0 6px;
        -webkit-border-radius: 0 0 0 6px;
        border-radius: 0 0 0 6px;
    }

    .bordered_dark tr:last-child td:last-child {
        -moz-border-radius: 0 0 6px 0;
        -webkit-border-radius: 0 0 6px 0;
        border-radius: 0 0 6px 0;
    }





    .bordered_gray th:first-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_gray th:last-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_gray th:only-child{
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_gray tr:last-child td:first-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_gray tr:last-child td:last-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }





    .bordered_white th:first-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_white th:last-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_white th:only-child{
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_white tr:last-child td:first-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }

    .bordered_white tr:last-child td:last-child {
        -moz-border-radius: 0 0 0 0;
        -webkit-border-radius: 0 0 0 0;
        border-radius: 0 0 0 0;
    }



    .title_blue {
        color: #009da5;
        font-weight: bold;
    }

    .title_white {
        color: #ffffff;
        font-weight: bold;
    }


    .td_blue td {
        border-left: 5px solid #2b4950 !important;
        border-top: 5px solid #2b4950 !important;
    }

</style>
</head>
<body>

<table width="845px;" border="0" style="padding-bottom:20px">
  <th style="text-align:left;width:155px">
    <%=absolute_image_tag('logo_lca_to_go.png', :width => 147)%>
  </th>
  <th style="text-align:left;width:155px">
    <%=absolute_image_tag('logos/logo_photovoltaics.png', :width => 147)%>
  </th>
  <th align="right">
    <table class="bordered" style="width:500px;color:#ffffff">
      <th>
        <b><%=_('Organisation').html_safe%>:</b> <%=@product.organisation%><br/>
        <b><%=_('Author').html_safe%>:</b> <%=@product.person_name%><br/>
        <b><%=_('Name of the product').html_safe%>:</b> <%=@product.name%><br/>
        <b><%=_('Version of the product').html_safe%>:</b> <%=@product.version%><br/>
        <b><%=_('Description of the product').html_safe%>:</b> <%=@product.description%><br/>
      </th>
    </table>
  </th>
</table>


<h2><%=@product.name%></h2>

<table  class="bordered" width="845px;" style="border-top: solid #2b4950 5px">
  <tr>
    <th style="background:#008B8B"><%=_('Energy Payback Time').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.energy_payback, 2)%> years</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Net saved CO2').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.net_saved_co2, 2)%> kg CO2</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Lifetime electricity production').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_result.lifetime, 2)%> kWh</td>
  </tr>
</table>

<br/>

<table class="bordered" width="845px;" style="border-top: solid #2b4950 5px">
  <tr>
    <th style="background:#008B8B"><%=_('Lifetime saved Primary Energy by replaced electricity').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.lifetime_saved, 2)%> MJ PE</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Estimated Peak Power').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.peak_power, 2)%> kWp</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Averaged yearly electricity production').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.averaged_power, 2)%> kWh/a</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Averaged yearly avoided consumption of Primary Energy').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.averaged_consumption, 2)%> MJ</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Energy yield Ratio').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.energy_yield, 2)%></td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Estimated CO2-equivalent emissions per kWh electricty produced').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.estim_co2, 2)%> g/kWh</td>
  </tr>
  <tr>
    <th style="background:#008B8B"><%=_('Temperature induced efficiency losses').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(@ph_product.ph_embedded_result.temperature_induced, 2)%>%</td>
  </tr>
</table>
<br/>
<% @products_checked.each do |ph_product| %>
    <h2><%=ph_product.product.name%></h2>
    <%
       energy_payback = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.energy_payback
       net_saved_co2 = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.net_saved_co2
       lifetime = (ph_product.ph_result.blank?)?0:ph_product.ph_result.lifetime
       lifetime_saved = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.lifetime_saved
       peak_power = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.peak_power
       averaged_power = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.averaged_power
       averaged_consumption = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.averaged_consumption
       energy_yield = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.energy_yield
       estim_co2 = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.estim_co2
       temperature_induced = (ph_product.ph_embedded_result.blank?)?0:ph_product.ph_embedded_result.temperature_induced


    %>
    <table  class="bordered" width="845px;" style="border-top: solid #2b4950 5px">
      <tr>
        <th style="background:#008B8B"><%=_('Energy Payback Time').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(energy_payback, 2)%> years</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Net saved CO2').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(net_saved_co2, 2)%> kg CO2</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Lifetime electricity production').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(lifetime, 2)%> kWh</td>
      </tr>
    </table>

    <br/>

    <table class="bordered" width="845px;" style="border-top: solid #2b4950 5px">
      <tr>
        <th style="background:#008B8B"><%=_('Lifetime saved Primary Energy by replaced electricity').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(lifetime_saved, 2)%> MJ PE</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Estimated Peak Power').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(peak_power, 2)%> kWp</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Averaged yearly electricity production').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(averaged_power, 2)%> kWh/a</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Averaged yearly avoided consumption of Primary Energy').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(averaged_consumption, 2)%> MJ</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Energy yield Ratio').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(energy_yield, 2)%></td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Estimated CO2-equivalent emissions per kWh electricty produced').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(estim_co2, 2)%> g/kWh</td>
      </tr>
      <tr>
        <th style="background:#008B8B"><%=_('Temperature induced efficiency losses').html_safe%> </th><td style="text-align:center"> <%=lca_format_number(temperature_induced, 2)%>%</td>
      </tr>
    </table>
    <br/>


<% end %>



<h2><%=_('Comparison').html_safe%></h2>

<table class="bordered" width="845px;">

  <th><span class="title_white"><%=_('Carbon footprint').html_safe%></span></th>

<%
   # 7 --> phases selected
   height =  (7 * 14) + ((@products_checked.size + 1) * 7) * 14 + 30
   axis_format = ''
   axis_format_energy = ''
   index_axis = 0
   while index_axis <=  @products_checked.size
     axis_format += 'N*f0*,000000,' + index_axis.to_s + ',-1,11,,:10:'
     axis_format_energy += 'N*f2*,000000,' + index_axis.to_s + ',-1,11,,:10:'
     if index_axis != @products_checked.size
       axis_format += '|'
       axis_format_energy += '|'
     end
     index_axis = index_axis + 1
   end
%>

  <tr>
    <td style="text-align:center">
        <img
        alt=""
        src="https://chart.googleapis.com/chart?chf=bg,s,EBEEDB|c,s,FFFDF6&amp;chbh=14&amp;chts=2B4950,16,l&amp;chxt=x,y&amp;cht=bhg&amp;chds=a&amp;chd=t:<%=@values_co2_to_array%>&amp;chco=<%=@seriesColors_to_array%>&amp;chls=2.0&amp;chs=530x<%=height%>&amp;chxl=1:<%=@ticks_to_array%>&amp;chm=<%=axis_format%>&amp;chdl=<%=@legend%>"
        style="padding-right:20px;padding-bottom:0px;">
        <div style="width:845px;text-align:center;font-size:11px;padding-bottom:20px"><%=_('Carbon footprint (kg CO<sub>2</sub>-eq)').html_safe%></div>

    </td>
  </tr>
</table>
<br/>

<table class="bordered" width="845px;">

  <th><span class="title_white"><%=_('Energy').html_safe%></span></th>
  <tr>
    <td style="text-align:center">
        <img
        alt=""
        src="https://chart.googleapis.com/chart?chf=bg,s,EBEEDB|c,s,FFFDF6&amp;chbh=14&amp;chts=2B4950,16,l&amp;chxt=x,y&amp;cht=bhg&amp;chds=a&amp;chd=t:<%=@values_pe_to_array%>&amp;chco=<%=@seriesColors_to_array%>&amp;chls=2.0&amp;chs=530x<%=height%>&amp;chxl=1:<%=@ticks_to_array%>&amp;chm=<%=axis_format_energy%>&amp;chxs=1,,11,-1,lt&amp;chdl=<%=@legend%>"
        style="padding-right:20px;padding-bottom:0px;">
        <div style="width:845px;text-align:center;padding-bottom:20px;font-size:11px;"><%=_('Energy Payback time (years)').html_safe%></div>
    </td>
  </tr>
</table>
<br/>

<table class="bordered" width="845px;">

  <th><span class="title_white"><%=_('Lifetime electricity production').html_safe%></span></th>
  <tr>
    <td style="text-align:center">



        <% height_lifetime = (@products_checked.size * 26)  + 32 %>

        <img
        alt=""
        src="https://chart.googleapis.com/chart?chf=bg,s,EBEEDB|c,s,FFFDF6&amp;chbh=18&amp;chts=2B4950,16,l&amp;chxt=x,y&amp;cht=bhg&amp;chds=a&amp;chd=t:<%=@values_lifetime_to_array%>&amp;chco=<%=@seriesColors_to_array%>&amp;chls=2.0&amp;chs=600x<%=height_lifetime%>&amp;chxl=1:<%=@ticks_lifetime_to_array%>&amp;chm=<%=axis_format%>&amp;chxs=1,,11,-1,lt&amp;chdl=<%=@legend%>"
        style="padding-right:20px;padding-bottom:0px;">
        <div style="width:845px;text-align:center;padding-bottom:20px;font-size:11px;"><%=_('Lifetime electricity production (kWh)').html_safe%></div>
    </td>
  </tr>
</table>


</body>
</html>
